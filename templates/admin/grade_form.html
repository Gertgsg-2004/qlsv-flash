{% extends "base.html" %}
{% set title = "Thêm điểm" if mode=="create" else "Sửa điểm" %}
{% block content %}

<div class="card text-dark">
  <div class="card-header d-flex justify-content-between align-items-center">
    <b>{{ "Thêm điểm" if mode=="create" else "Sửa điểm" }}</b>
    <a class="btn btn-secondary btn-sm" href="{{ url_for('admin.admin_grades') }}">Quay lại</a>
  </div>

  <div class="card-body">
    <form method="POST">
      {{ form_csrf_token()|safe }}

      <div class="mb-3">
        <label class="form-label">Sinh viên</label>
        <select class="form-select" name="student_id" required>
          <option value="">-- Chọn sinh viên --</option>
          {% for u in students %}
            <option value="{{ u.id }}"
              {% if g and g.student_id == u.id %}selected{% endif %}>
              {{ u.ma_sv }} - {{ u.ten_sv }} ({{ u.email }})
            </option>
          {% endfor %}
        </select>
      </div>

      <div class="mb-3">
        <label class="form-label">Môn học</label>
        <select class="form-select" name="subject_id" required>
          <option value="">-- Chọn môn --</option>
          {% for s in subjects %}
            <option value="{{ s.id }}"
              {% if g and g.subject_id == s.id %}selected{% endif %}>
              {{ s.code if s.code else s.id }} - {{ s.name if s.name else "" }}
            </option>
          {% endfor %}
        </select>
      </div>

      <div class="mb-3">
        <label class="form-label">Kỳ thi</label>
        <select class="form-select" name="exam_id" required>
          <option value="">-- Chọn kỳ thi --</option>
          {% for e in exams %}
            <option value="{{ e.id }}"
              {% if g and g.exam_id == e.id %}selected{% endif %}>
              {{ e.name if e.name else ("Kỳ thi #" ~ e.id) }}
            </option>
          {% endfor %}
        </select>
      </div>

      <div class="mb-3">
        <label class="form-label">Điểm</label>
        <input class="form-control" name="score" required
               value="{{ g.score if g else '' }}" placeholder="0 - 10">
        <div class="text-muted" style="font-size:12px;">Điểm dạng số (VD: 8.5)</div>
      </div>

      <div class="mb-3">
        <label class="form-label">Ghi chú</label>
        <textarea class="form-control" name="note" rows="3">{{ g.note if g and g.note else "" }}</textarea>
      </div>

      <button class="btn btn-primary">Lưu</button>
    </form>
  </div>
</div>

{% endblock %}
